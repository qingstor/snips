sudo: required
language: go
go:
  - 1.8
  - 1.7
  - 1.6
cache:
  directories:
    - $HOME/gopath
before_install:
    - pushd $HOME/gopath
    - if [[ ! -d "./make-4.0" ]]; then
          wget http://ftp.gnu.org/gnu/make/make-4.0.tar.gz &&
          tar -vxzf make-4.0.tar.gz &&
          pushd make-4.0 && ./configure && make && popd;
      fi
    - pushd make-4.0 && sudo make install && popd
    - if [[ ! -d "./glide-v0.12.3" ]]; then
          wget https://github.com/Masterminds/glide/releases/download/v0.12.3/glide-v0.12.3-linux-amd64.tar.gz &&
          tar -vxzf glide-v0.12.3-linux-amd64.tar.gz &&
          mv linux-amd64 glide-v0.12.3;
      fi
    - export PATH=$HOME/gopath/glide-v0.12.3:$PATH
    - /usr/local/bin/make --version
    - glide --version
install:
  - go get -u github.com/golang/lint/golint
  - pushd $GOPATH/src/github.com/yunify/snips 
  - glide install 
  - popd
script:
  - pushd $GOPATH/src/github.com/yunify/snips
  - /usr/local/bin/make check
  - /usr/local/bin/make build
  - /usr/local/bin/make release
  - /usr/local/bin/make clean
  - /usr/local/bin/make test
  - /usr/local/bin/make test-coverage
  - popd
